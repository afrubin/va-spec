# GKS-based Representation of gnomAD Population Allele Frequency Data
# Allele record used in data examples: https://gnomad.broadinstitute.org/variant/1-55505485-G-A

# VA-SEPIO based proposals leverage the VA-SEPIO 'StudyResult' Class.
# This class gets specialized to create a domain-specific 'PopulationAlleleFrequencyStudyResult' subclass, for which we define dedicated named attributes for each type of data item that can be captured (e.g. PopulationAlleleFrequencyStudyResult.alleleFrequency)
# The data item-specific attributes defined for this subclass will support two different use cases:
   # I.  Reepresenting the calculated Popmax Filtering AF for the variant (along with some metadata/provenance info)
   # II. Representing more foundational allele count and frequency data for the variant in specific populations/subpopulations (along with metadata/provenance info)

# Data providers will create separate, stand-alone StudyResult objects for each discrete population in which we want to describe a particular type of frequency data (popmax vs straight frequency), for a given variation.
# External guidance/conventions will provide additional instruction for how to apply this single subtype to support these different types of frequency information (e.g. what attributes are required for the popmax use case vs the foundational frequency use case) 

#-----------------------------------------------------------------------------------------------#

# Scenario 1.  A StudyResult showing the 95% CI filtering AF score for the 1-55505485-G-A allele, based on exome data from the global gnomAD v2.1.1 dataset (i.e. all ancestries, 141,456 samples)

- id: cg-data:Result101
  type: Population Allele Frequency Study Result 
  subtype: PopMax FAF 95 Result        # Tells us that the frequency value in this Result object is a 95%CI Popmax FAF
  derivedFrom:                         
    - id: cg-data:DataSet101           # This is the gnomad dataset from which data items reported in this Result came (the full gnomAD v2.1.1 dataset, all ancestries, 141,456 samples -see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet
      label: gnomAD                    # Since we capture 'Exome' in an extension field for now,  we don't need to create a bespoke dataset for only the exome subset of the gnomAD 2.1.1. This means we can keep the datasets referenced here to actual datasets defined/identified by the gnomAD, and not have to create/name/identify bespoke subsets. 
      version: 2.1.1       
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  focus_descriptor: cg-data:Descriptor001
  population:                    
    id: cg-data:Pop001
    type: Population
    label: gnomAD v2.1.1 AFR           # For popmax, we restrict to the specific superpopulation/ancestry that the basis for the reported Popmax FAF calculation (here, AFR)- as ultimately this is the population that the main data items in the Result describe
    characteristics:                   # Under the current proposal, study subject info that would be captured in a Population object here would include ancestry and sex.  Things like cancer status or neuro disease status on which gnomad bases their data subsets - which are 'fundamentally' characteristics of subjects in a Population, could also be captured here  (but may more pragmatically be captured in the source DataSet captured in the 'derivedFrom' field).
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        values: 
          - AFR                  
  specifiedBy:           
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
    - id: cg-data:Method002
      type: Method
      label: Popmax filtering allele frequency method   # We no longer *NEED* to provide this to indicate that the reported AF is a 95% PopmaxFAF, as this distinction is made in the subtype field  but including it would let us provide a reference to the pub describing the Popmax method.
      references:          
        - id: cg-data:Document002
          identifiers: 
            - doi:10.1038/gim.2017.26
            - pmid:28518168
            - pmcid:5563454 
          type: Document
          subtype: Publication    # If useful, we could define an enum of Document types relevant for this work, and use it here (e.g. 'Publication', 'Abstract', White Paper', 'Report', . . .)
          title: "Using high-resolution variant frequencies to empower clinical genome interpretation"
      urls:                              
        - https://www.nature.com/articles/gim201726
  frequency: 0.01937              # The 95%CI calculation of the Popmax FAF (IMO we should define a different attribute for the PopmaxFAF value - as it is fundamentally a different thing than a simple AF that reports the ACTUAL frequency of the variant in an interrogated population - see below).
  alternateAlleleCount: 236       # gnomad 'AC' for the AFR subpopulation . . . provenance behind the FAF calculation
  totalAlleleCount: 10912         # gnomad 'AN' for the AFR subpopulation . . . provenance behind the FAF calculation

  extensions:
    - name: data_subset_type      # consider if this is best name/concept here - may depend on this methogology LB mentioned for cobining E and G data for popmax calculations
      value: Exomes
    - name: mean_coverage_depth_exomes
      value: 52.4   

#---------------------------------------------------------------------------------------------------#

# Scenario 2.  A StudyResult showing the **99% CI** filtering AF score, based on exome data from the gnomAD v2.1.1 dataset 

## Difference from Scenario 1: Popmax FAF score is at 99% CI instead of 95% CI

- id: cg-data:Result103
  type: Population Allele Frequency Study Result 
  subtype: Exome PopMax FAF 99 Result       # This value here is the only difference from Scenario 1 above (along wiht the different value of the 'frequency' field below)
  derivedFrom:                         
    - id: cg-data:DataSet101           
      type: DataSet
      label: gnomAD                    
      version: 2.1.1       
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  focus_descriptor: cg-data:Descriptor001
  population:                    
    id: cg-data:Pop001
    type: Population
    label: gnomAD v2.1.1 AFR           
    characteristics:                   
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        values: 
          - AFR                  
  specifiedBy:           
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
    - id: cg-data:Method002
      type: Method
      label: Popmax filtering allele frequency method   
      references:          
        - id: cg-data:Document002
          identifiers: 
            - doi:10.1038/gim.2017.26
            - pmid:28518168
            - pmcid:5563454 
          type: Document
          subtype: Publication    
          title: "Using high-resolution variant frequencies to empower clinical genome interpretation"
      urls:                              
        - https://www.nature.com/articles/gim201726
  frequency: 0.01524              # The 99%CI calculation of the Popmax FAF 
  alternateAlleleCount: 236       # gnomad 'AC' for the AFR subpopulation . . . provenance behind the FAF calculation
  totalAlleleCount: 10912         # gnomad 'AN' for the AFR subpopulation . . . provenance behind the FAF calculation

  extensions:
    - name: data_subset_type      # consider if this is best name/concept here - may depend on this methogology LB mentioned for cobining E and G data for popmax calculations
      value: Exomes
    - name: mean_coverage_depth_exomes
      value: 52.4   


#---------------------------------------------------------------------------------------------------#

# Scenario 3. A StudyResult showing the *true* allele frequency for the 1-55505485-G-A allele, based on exome and genome data from subjects of any ancestry in the 'non-cancer' subset of gnomAD 2.1.1  

## Difference from Scenario 2: Frequency value is the *true allele frequency*, sourced from exome and genome data from non-cancer subjects of all ancestries

- id: cg-data:Result1003
  type: Population Allele Frequency Study Result 
  subtype: True Population Allele Frequency Result    # Tells us that the frequency value in this Result object is a the true calculated frequency in the indicated population / subset
  derivedFrom:                         
    - id: cg-data:DataSet103           # This is the gnomad dataset from which data items reported in this Result came (the 'non-cancer' subset of gnomAD v2.1.1 data, all ancestries, 134,187 samples. But it would be fine to just reference the full 2.1.1 dataset here, as the 'control' status of individuals is captured in the Population description below.
      type: DataSet
      label: gnomAD non-cancer         # 'non-cancer' is referenced here because this is an official sub-dataset defined by gnomad - see https://gnomad.broadinstitute.org/help/dataset-selection. But it would be fine to just reference the full 2.1.1 dataset here, as the 'non-cancer' status of individuals is captured in the Population description below.  
      version: 2.1.1       
      partOf: cg-data:DataSet101       # gnomAD v2.1.1  
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  focus_descriptor: cg-data:Descriptor001
  population:                    
    id: cg-data:Pop003
    type: Population
    label: gnomAD v2.1.1 global, non-cancer           
    characteristics:             # Under the current proposal, study subject info captured in a Population object here would include ancestry (global) and research study role (controls). 
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        values: 
          - global                  
      - name: diagnosis
        description: a disease or phenotype manifest/diagnosed in the individual
        value: Cancer            # A non-cancer status naturally fits as a characteristic of the Result Population, so we capture it here (in addition to capturing 'non-cancer' in the source dataset, since gnomAD defines this as a named sub-dataset - no big harm in redundancy)
        exclude: true
  specifiedBy:           
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  frequency: 0.002727             # The true calcualted AF for the variant in the indicated population of participants.
  alternateAlleleCount: 557       # gnomad 'AC' for the indicated population . . . provenance behind the AF calculation
  totalAlleleCount: 204,286         # gnomad 'AN' for the indicated subpopulation . . . provenance behind the AF calculation

  extensions:
    - name: data_subset_type      
      value: Exomes + Genomes
    - name: homozygous_individual_count
      value: 3 
    - name: mean_coverage_depth_exomes   # Question: The exome and genome coverage depth metadata may not be appropriate here, as these values are across the *global* exome/genome populations (not just the 'non-cancer' subset). If we do remove this from the Result, user can still trace back to it by following population isSubsetOf hierarchy back to assessment of global population for this variant)
      value: 52.4   
    - name: mean_coverage_depth_genomes
      value: 35.9


#---------------------------------------------------------------------------------------------------#

# Scenario 4. A StudyResult showing the *true* allele frequency for the 1-55505485-G-A allele, based on exome data from NFE females in the *control* subset of gnomAD v2.1.1 data (all ancestries, 60,146  samples)

## Difference from Scenario 3: Source dataset and Result Population is different - female, NFE subjects in the control subset of gnomAD

- id: cg-data:Result104
  type: Population Allele Frequency Study Result
  subtype: True Population Allele Frequency Result   
  derivedFrom:                         
    - id: cg-data:DataSet104
      type: DataSet
      label: gnomAD controls       
      version: 2.1.1      
      partOf: cg-data:DataSet101       # gnomAD v2.1.1        
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  focus_descriptor: cg-data:Descriptor001
  population: 
    id: cg-data:Pop004                 # The Population captures the fact that the results reported here are based on data from the female NFE subpopulation. IMO we should also include the non-cancer characteristic/criteria here.  But leave it in the source Dataset as this is how gnomAD captures this info.
    type: Population
    label: gnomad v2  Non-Finnish European Females, Control
    isSubsetOf: cg-data:Pop002         # The NFE population that the non-cancer female subpopulation is a subset of.
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: Non-Finnish European
      - name: biological sex
        description: genetically defined biological sex of the individual (e.g. XX, XY, XXY, etc).
        value: XX
      - name: research_study_role      # Capturing this info here because it is fundamentally a characteristic of the individuals in the study population. The source dataset above also happens to reflect this 'control' status, but fundamentally it belongs here because it is a property of a study participant.
        description: role the individual played in a disease study in which they participated
        values: 
          - control
  specifiedBy:           
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  frequency: 0                    # The true calcualted AF for the variant in the indicated population of participants.
  alternateAlleleCount: 0         # gnomad 'AC' for the indicated subpopulation . . . provenance behind the AF calculation
  totalAlleleCount: 14774         # gnomad 'AN' for the indicated subpopulation . . . provenance behind the AF calculation

  extensions:
    - name: data_subset_type      
      value: Exomes + Genomes
    - name: homozygous_individual_count
      value: 0 
    - name: mean_coverage_depth_exomes   # Question: The exome and genome coverage depth metadata may not be appropriate here, as these values are across the *global* exome/genome populations (not just the 'control female NFE' subset). If we remove from this Result, user can still trace back to it by following population isSubsetOf hierarchy back to assessment of global population for this variant)
      value: 52.4   
    - name: mean_coverage_depth_genomes
      value: 35.9









#---------------------------------------------------------------------------------------------------#
#---------------------------------------------------------------------------------------------------#


# USE CASE II. Foundational Population Allele Frequency data for the 1-55505485-G-A allele.  Scenarios below demonstrate data for several different populations/subsets: global genome + exome, global exome only, NFE exome + genome, NWE exome + genome , and NFE females exome + genome

# Data examples only illustrated for the Proposal 1 approach, which adopts Larry's suggestion for the 'exome vs genome' distinction to be captured in the Result.subtype field.

## Scenario 1: Frequency data for the global population (all ancestries) based on genome and exome data (gnomad v 2.1.1, 141,456 samples)
  
- id: cg-data:Result200
  type: Population Allele Frequency Result
  subtype: Genome/Exome Population Allele Frequency Result  
  derivedFrom:                  
    - id: cg-data:DataSet101    # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1, all ancestries, 141,456 samples - see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet     
      label: gnomAD                      
      version: 2.1.1       
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo  
   resultPopulation: 
    id: cg-data:Pop001
    type: Population
    label: gnomad v2 global
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: global
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry  
  alternateAlleleCount: 577
  totalAlleleCount: 210122
  alleleFrequency: 0.002746
  homozygousIndividualCount: 3
  meanCoverageDepthExomes: 52.4    # This DataItem is a piece of metadata about the items above
  meanCoverageDepthGenomes: 35.9   # This DataItem is a piece of metadata about the items above


## Scenario 2: Frequency data for the global population (all ancestries) based on *exome data only*
- id: cg-data:Result201
  type: Population Allele Frequency Result
  subtype: Exome Population Allele Frequency Result  # The subtype designation captures the fact that the results reported here are based on exome data only. 
  derivedFrom:                         
    - id: cg-data:DataSet101                         # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1, all ancestries, 141,456 samples - see https://gnomad.broadinstitute.org/help/dataset-selection). 
      type: DataSet
      label: gnomAD              
      version: 2.1.1            
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo  
  resultPopulation: 
    id: cg-data:Pop001
    type: Population
    label: gnomad v2 global
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: global
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  alternateAlleleCount: 385
  totalAlleleCount: 178712
  alleleFrequency: 0.002154
  homozygousIndividualCount: 2
  meanCoverageDepthExomes: 52.4    # Only showing coverage depth for exomes as pop freq data is based on exomes only

	  
## Scenario 3: Frequency data for the *Non-Finnish European (NFE) subset* of the global population, based on *genome and exome data*
- id: cg-data:Result202
  type: Population Allele Frequency Result 
  subtype: Genome/Exome Population Allele Frequency Result    # The subtype designation captures the fact that the results reported here are based on genome and exome data. 
  derivedFrom:            
    - id: cg-data:DataSet101       # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1, all ancestries, 141,456 samples -see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet     
      label: gnomAD                    
      version: 2.1.1    
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  resultPopulation:             
    id: cg-data:Pop002             # The Population captures the fact that the results reported here are based on data from the NFE subpopulation
    type: Population
    label: gnomad v2 Non-Finnish European
    isSubsetOf: cg-data:Pop001     # Indicates larger populations the NFE population is a part of (here, the global v2 gnomad study population)
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: Non-Finnish European
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  alternateAlleleCount: 23
  totalAlleleCount: 88888
  alleleFrequency: 0.0002588
  homozygousIndividualCount: 0
  meanCoverageDepthExomes: 52.4   # Question: The exome and genome coverage depth metadata may not be appropriate here, as these values are across the *global* exome/genome populations (not jsut the NFE subset). If we remove from this Result, user can still trace back to it by following population isSubsetOf hierarchy back to assessment of global population for this variant)
  meanCoverageDepthGenomes: 35.9   
  
  

## Scenario 4: Frequency data for the *Non-western European subset* of the NFE population, based on *genome and exome data*
- id: cg-data:Result203
  type: Population Allele Frequency Result 
  subtype: Genome/Exome Population Allele Frequency Result    # The subtype designation captures the fact that the results reported here are based on genome and exome data.   
  derivedFrom:            
    - id: cg-data:DataSet101      # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1, all ancestries, 141,456 samples -see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet     
      label: gnomAD                      
      version: 2.1.1    
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo  
  resultPopulation: 
    id: cg-data:Pop003           # The Population captures the fact that the results reported here are based on data from the Northwestern European subpopulation
    type: Population
    label: gnomad v2 North-western European
    isSubsetOf: cg-data:Pop002   # Indicates larger populations this one is a part of (here, the NFE gnomad population)
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: North-western European
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  alternateAlleleCount: 5
  totalAlleleCount: 44582
  alleleFrequency: 0.001180
  homozygousIndividualCount: 0
  meanCoverageDepthExomes: 52.4   
  meanCoverageDepthGenomes: 35.9   


## Scenario 5: Frequency data for the *female Non-Finnish European (NFE) subset* of the global population, based on *genome and exome data*
- id: cg-data:Result204
  type: Population Allele Frequency Result 
  subtype: Genome/Exome Population Allele Frequency Result    # The subtype designation captures the fact that the results reported here are based on genome and exome data.    
  derivedFrom:            
    - id: cg-data:DataSet101      # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1, all ancestries, 141,456 samples -see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet     
      label: gnomAD                     
      version: 2.1.1    
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo   
  resultPopulation: 
    id: cg-data:Pop004            # The Population captures the fact that the results reported here are based on data from the female Northwestern European subpopulation
    type: Population
    label: gnomad v2 Non-Finnish European, female
    isSubsetOf: cg-data:Pop002    # The Northwestern European population that the female subpopulation is a subset of.
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: Non-Finnish European
      - name: biological sex
        description: genetically defined biological sex of the individual (e.g. XX, XY, XXY, etc).
        value: XX
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  alternateAlleleCount: 5
  totalAlleleCount: 39862
  alleleFrequency: 0.0001254
  homozygousIndividualCount: 0
  meanCoverageDepthExomes: 52.4   
  meanCoverageDepthGenomes: 35.9   

## Scenario 6: Frequency data for the *female Non-Finnish European (NFE) subset* of the global population, in the *non-cancer subset*, based on *genome and exome data*
- id: cg-data:Result204
  type: Population Allele Frequency Result 
  subtype: Genome/Exome Population Allele Frequency Result    # The subtype designation captures the fact that the results reported here are based on genome and exome data.  
  derivedFrom:            
    - id: cg-data:DataSet105      # This is the gnomad dataset from which data items reported in this Result came (gnomAD v2.1.1 non-cancer, all ancestries, 134,456 samples -see https://gnomad.broadinstitute.org/help/dataset-selection).
      type: DataSet     
      label: gnomAD                     
      version: 2.1.1      
  focus: ga4gh:VA.G0OEtRYqBBfrfzG1XUH73Vn9ax-9dcAo  
  resultPopulation: 
    id: cg-data:Pop004            # The Population captures the fact that the results reported here are based on data from the female Northwestern European subpopulation. IMO we should also include the noncancer characteristic/criteria here.  But leave it in the source Dataset as this is how gnomAD  captures this info.
    type: Population
    label: gnomad v2 Non-Finnish European, female
    isSubsetOf: cg-data:Pop002    # The Northwestern European population that the female subpopulation is a subset of.
    characteristics:
      - name: ancestry
        description: genetic ancestry of the individual, as defined here: https://gnomad.broadinstitute.org/help/ancestry
        value: Non-Finnish European
      - name: biological sex
        description: genetically defined biological sex of the individual (e.g. XX, XY, XXY, etc).
        value: XX
      - name: diagnosis
        description: a disease or phenotype manifest/diagnosed in the individual
        value: Cancer             # A non-cancer status naturally fits s a characteristic of the resultPopulation, and we could choose to capture it here as shown (perhaps in addition to capturing non-cancer population in the source dataset - no big harm in redundancy)
        exclude: true
  specifiedBy:                    
    - id: cg-data:Method001
      type: Method
      label: GnomAD population ascertainment method
      references:                      
        - id: cg-data:Document001
          title: Ancestry in gnomAD
          urls: 
            - https://gnomad.broadinstitute.org/help/ancestry
  alternateAlleleCount: 4
  totalAlleleCount: 37334
  alleleFrequency: 0.0001071
  homozygousIndividualCount: 0
  meanCoverageDepthExomes: 52.4   
  meanCoverageDepthGenomes: 35.9   

